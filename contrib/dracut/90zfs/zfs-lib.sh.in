#!/bin/sh

command -v getarg >/dev/null || . /lib/dracut-lib.sh

OLDIFS="${IFS}"
NEWLINE="
"

# mount_dataset DATASET
#   mounts the given zfs dataset.
mount_dataset() {
	local dataset="${1}"
	local mountpoint="$(zfs get -H -o value mountpoint "${dataset}")"

	# We need zfsutil for non-legacy mounts and not for legacy mounts.
	if [ "${mountpoint}" = "legacy" ] ; then
		mount -t zfs "${dataset}" "${NEWROOT}" 2>&1 >/dev/null
	else
		mount -o zfsutil -t zfs "${dataset}" "${NEWROOT}" \
			2>&1 >/dev/null
	fi

	return $?
}
