# Makefile.in for spl kernel module

MODULES := spl
DISTFILES = Makefile.in \
            spl-kmem.c spl-rwlock.c spl-taskq.c \
            spl-thread.c spl-generic.c
EXTRA_CFLAGS = @KERNELCPPFLAGS@

# Solaris porting layer module
obj-m := spl.o

spl-objs += spl-debug.o
spl-objs += spl-proc.o
spl-objs += spl-kmem.o
spl-objs += spl-thread.o
spl-objs += spl-taskq.o
spl-objs += spl-rwlock.o
spl-objs += spl-vnode.o
spl-objs += spl-err.o
spl-objs += spl-time.o
spl-objs += spl-kobj.o
spl-objs += spl-module.o
spl-objs += spl-generic.o
spl-objs += spl-atomic.o
spl-objs += spl-mutex.o
spl-objs += spl-kstat.o
spl-objs += spl-condvar.o

splmodule := spl.ko
splmoduledir := @kmoduledir@/kernel/lib/

install:
	mkdir -p $(DESTDIR)$(splmoduledir)
	$(INSTALL) -m 644 $(splmodule) $(DESTDIR)$(splmoduledir)/$(splmodule)
	-/sbin/depmod -a

uninstall:
	rm -f $(DESTDIR)$(splmoduledir)/$(splmodule)
	-/sbin/depmod -a

clean:
	-rm -f $(splmodule) *.o .*.cmd *.mod.c *.ko *.s */*.o

distclean: clean
	rm -f Makefile
	rm -rf .tmp_versions

maintainer-clean: distclean

distdir: $(DISTFILES)
	cp -p $(DISTFILES) $(distdir)
